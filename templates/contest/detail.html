{% extends 'base.html' %}
{% load static %}


{% block title %}Contest Features{% endblock %}

{% block body %}

<section id= "contest-detail-section" class="contest-detail-sec">
  <div class="inner-more">
    <div class="container">
        <!-- Ajax Content Here / CF -->
      </div>
    </div>
</section>

<script>

    $(document).ready( function(){
        $.ajax({
            url: '{% url 'contest_api:detail' slug=contest.slug %}',
            type: 'get',
            success: function(value){
                console.log(value);
                console.log(value["contest_name"]);

                var tagAsStr = '';
                $.each(value['tag'], function(index, data){
                      tagAsStr += "#" + data.title + " ";
                });

                var getContestStartDate = new Date(value["start_date"]);  // Get Contest End Date in ISO Format
                var getContestEndDate = new Date(value["end_date"]);  // Get Contest Start Date in ISO Format
                year = [getContestStartDate.getFullYear() , getContestEndDate.getFullYear()]
                month = [getContestStartDate.getMonth(), getContestEndDate.getMonth()]
                dt = [getContestStartDate.getDate(), getContestEndDate.getDate()]

                //add 0 if date,months are not 2 digits
                if (dt<10) {
                  dt = '0' + dt;
                }

                var monthNames = ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"];  //Change month number to String
                contestStartDate = dt[0] + '/' + monthNames[month[0]] + '/' + year[0];  //COnverted to Short Date Format,
                contestEndtDate = dt[1] + '/' + monthNames[month[1]] + '/' + year[1];  //COnverted to Short Date Format

                console.log(contestStartDate);

                var contestDetailContent = "<div class=\"row\">\n" +

                                            "  <div class=\"col-lg-6 img-col\">\n" +
                                            "    <div class=\"contest-img-wrap\">\n" +
                                            "     <img src='/../static/images/home-images/1.jpg'>\n" +
                                            "    </div>\n" +
                                            "  </div>\n" +

                                            "   <div class=\"col-lg-6 contest-detail-col\">\n" +
                                            "    <div class=\"contest-detail-content-wrap\">\n" +
                                            "      <table class=\"table table-hover\">\n" +
                                            "        <tbody>\n" +

                                            "          <tr>\n" +
                                            "            <th>Contest Name</th>\n" +
                                            "            <td>"+ value["contest_name"] +"</td>\n" +
                                            "          </tr>\n" +

                                            "          <tr>\n" +
                                            "            <th>Start Date</th>\n" +
                                            "            <td class=\"contest-start-date\">"+ contestStartDate +"</td>\n" +
                                            "          </tr>\n" +

                                            "          <tr>\n" +
                                            "            <th>End Date</th>\n" +
                                            "            <td class=\"contest-end-date\">"+ contestEndtDate +"</td>\n" +
                                            "          </tr>\n" +

                                            "          <tr>\n" +
                                            "            <th>Price Distribution</th>\n" +
                                            "            <td>\n" +
                                            "              <button id=\"prize-open-btn\" class=\"btn-txt-only\"><i class=\"fa fa-chevron-down\"></i></button>\n" +
                                            "              <ul class=\"prize-list\">\n" +
                                            "                <li><span>1</span> <strong>500$</strong> <span>+Hawaii Vacation</span></li>\n" +
                                            "               <li><span>2</span> <strong>100$</strong> <span>+Bosphorus Tour</span></li>\n" +
                                            "                <li><span>3</span> <strong>50$</strong> <span></span></li>\n" +
                                            "                <li><span>4-20</span> <strong>10$</strong> <span></span></li>\n" +
                                            "              </ul>\n" +
                                            "            </td>\n" +
                                            "          </tr>\n" +

                                            "          <tr class=\"tr-btn-wrap\">\n" +
                                            "            <th>Details</th>\n" +
                                            "            <td><button id=\"mini-detail-open-btn\" class=\"btn-txt-only\"><i class=\"fa fa-chevron-down\"></i></button></td>\n" +
                                            "          </tr>\n" +

                                            "        </tbody>\n" +
                                            "      </table>\n" +
                                            "      <div id=\"contest-details-wrap-mini\">\n"+ 
                                            "         <table class=\"table table-mini-details\">\n"+
                                            "            <tbody>\n"+
                                            "               <tr>\n" +
                                            "                  <th>Minimum amount of votes you need to distribute</th>\n"+
                                            "                  <td>"+ value["min_must_votes"] +"</td>\n"+
                                            "               </tr>\n" +

                                            "               <tr>\n" +
                                            "                  <th>Minimum average</th>\n"+
                                            "                  <td>"+ value["min_avg"] +"</td>\n"+
                                            "               </tr>\n" +

                                            "               <tr>\n" +
                                            "                  <th>Minimum standard deviation</th>\n"+
                                            "                  <td>"+ value["min_stddev"] +"</td>\n"+
                                            "               </tr>\n" +

                                            "               <tr>\n" +
                                            "                  <th>Number of Photos in photopool</th>\n"+
                                            "                  <td>2</td>\n"+
                                            "               </tr>\n" +

                                            "               <tr>\n" +
                                            "                  <th>Maximum number of photos you can send</th>\n"+
                                            "                  <td>"+ value["max_photos_per_Reguser"] +"</td>\n"+
                                            "               </tr>\n" +

                                            "            </tbody>\n"+
                                            "         </table>\n" +
                                            "      </div>\n" +
                                            "      <div class=\"button-wrap\">\n" +
                                            "            {% if request.user.is_authenticated %}\n" +
                                            "            <form action='{% url 'contest:photo_upload' slug=contest.slug %}'>\n" +
                                            "              <input class=\"btn btn-fill\" type=\"submit\" value=\"Send Photo\">\n" +
                                            "            </form>\n" +
                                            "            {% endif %}\n" +
                                            "            <form action='{% url 'contest:photopool' slug=contest.slug %}'>\n" +
                                            "                    <input class=\"btn btn-fill\" type=\"submit\" value=\"Photopool\">\n" +
                                            "            </form>\n" +
                                            "            <form action='{% url 'contest:rankings' slug=contest.slug %}'>\n" +
                                            "                    <input class=\"btn btn-fill\" type=\"submit\" value=\"Rankings\">\n" +
                                            "            </form>\n" +
                                            "      </div>\n" +
                                            "      <div class=\"contest-tags-wrap\">\n" +
                                            "        <div class=\"tags-wrap\">\n" + tagAsStr +
                                            "        </div>\n" +
                                            "        <button class=\"btn-txt-only\"><i class=\"fa fa-chevron-down\"></i></button>\n" +
                                            "        <form class=\"form-report\" onclick='report('{{ contest.id }}')'>\n" +
                                            "            <input class=\"btn-report\" type=\"submit\" value=\"Report\" />\n" +
                                            "        </form>\n" +
                                            "      </div>\n" +
                                            "    </div>\n" +
                                            "  </div>\n";

                $(contestDetailContent).appendTo('#contest-detail-section .container');
                $(document).ready(function(){
                  
                  var val = 1;
                  $(".contest-detail-content-wrap .contest-tags-wrap>.btn-txt-only").click(function(){
                      if (val == 1) {
                          $(this).siblings('.form-report').show();
                          val = 0;
                      }
                      else {
                          val = 1;
                          $(this).siblings('.form-report').hide();
                      }
                      return false;
                    });
                

                $("#mini-detail-open-btn").click(function(){
                      if (val == 1) {
                          $('#contest-details-wrap-mini').css({
                            'visibility':'visible',
                            'opacity':'1'
                          });
                          val = 0;
                      }
                      else {
                          val = 1;
                          $('#contest-details-wrap-mini').css({
                            'visibility':'hidden',
                            'opacity':'0'
                          });
                      }
                      return false;
                    });
                

               $(".contest-detail-content-wrap #prize-open-btn").click(function(){
                        if (val== 1) {
                            $(this).siblings('.prize-list').css({
                            'visibility':'visible',
                            'opacity':'1',
                            'height':'100%'
                          });
                            $(this).css('transform','rotate(-180deg)');
                            val = 0;
                        }

                        else {
                            val = 1;
                            $(this).siblings('.prize-list').css({
                            'visibility':'hidden',
                            'opacity':'0',
                            'height':'0'
                          });
                            $(this).css('transform','rotate(0deg)');
                        }

                        return false;
                    });
               });
            },
            error:function(result){
                console.log('error: ' + result);
            }
        });
    });
</script>

<section style="margin-bottom: 50px;" class="examples">
    <div class="container">
        <div class="examples-top">
            <h3>{{ contest.contest_name }} Example Photos</h3>
        </div>
        <div class="examples-content">
            <div class="row">
                {% for example in examples %}
                    <div class="col-sm-4">
                        <div class="card" style="border-color: black;">
                            <img src="{{ example.photoItself.url }}" alt="Example Photo" style="width: 350px; height: 200px;">
                        </div>
                    </div>
                {% endfor %}
            </div>
        </div>
    </div>
</section>

    <!--<section class="white">
      <div class="inner-more">
        <div class="container">
          <div class="section-title text-center">
            <h3>Upgrade to gold membership and gain some advantages.<br> {{ contest.contest_name }} contest.</h3>
          </div>
          <table class="table comp-table">
            <thead>
              <tr>
                <td class="features-title">
                  <div class="title-height-add"></div>
                  <div>
                    <h2>FEATURES</h2>
                    <h5>COMPARISON</h5>
                  </div>
                </td>
                <td class="premium-title">
                  <div class="title-height-add"></div>
                  <span class="arrow-down"></span>
                  <h2>GOLD USER</h2>
                  <h3>7$<span>per month</span></h3>
                </td>
                <td class="regular-title">
                  <div class="title-height-add"></div>
                  <span class="arrow-down"></span>
                  <h2>FREE USER</h2>
                  <h3>0$</h3>
                </td>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>Minimum amount of votes you need to distribute<br> in order to take part in rankings</td>
                <td>5 {% if request.user.is_authenticated %}(You've distributed {{ contender.howmany_voted }}){% endif %}</td> <!--şimdilik 5 yazdım cunku databasede olusturmadım -
                <td>{{  contest.min_must_votes }} {% if request.user.is_authenticated %}(You've distributed {{ contender.howmany_voted }}){% endif %}</td>
              </tr>
              <tr>
                <td>Maximum number of photos you can send to photopool</td>
                <td>{{  contest.max_photos_per_Preuser }}</td>
                <td>{{  contest.max_photos_per_Reguser }}</td>
              </tr>
              <tr>
                <td>Min average of given points a contender must provide</td>
                <td>{{  contest.min_total_points_given }}</td>
                <td>{{  contest.min_total_points_given }}</td>
              </tr>
              <tr>
                <td>Free photo uploading for the first photo </td>
                <td ><i class="fa fa-check" aria-hidden="true"></i></td>
                <td ><i class="fa fa-check" aria-hidden="true"></i></td>
              </tr>
              <tr>
                <td>Free photo uploading after the first photo</td>
                <td><i class="fa fa-check" aria-hidden="true"></i></td>
                <td><i class="fa fa-times" aria-hidden="true"></i></td>
              </tr>
              <tr>
                <td>Stats Whisperer <a style="font-size:10px;" href="#">What is this?</a></td>
                <td><i class="fa fa-check" aria-hidden="true"></i></td>
                <td><i class="fa fa-times" aria-hidden="true"></i></td>
              </tr>
              <tr>
                <td></td>
                <td class="last-child-td-btn premium"><a href="#" class="plan-btn">Upgrade</a></td>
                <td class="last-child-td-btn regular"><a href="#" class="plan-btn">Sign Up</a></td>
              </tr>
            <tbody>
          </table>
        </div>
      </div>
    </section>-->

{% endblock %}